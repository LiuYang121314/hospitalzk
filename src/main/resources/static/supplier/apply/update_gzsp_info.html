<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>修改合同信息</title>
    <link rel="stylesheet" type="text/css" href="../../static/layui/css/layui.css"/>
    <link rel="stylesheet" type="text/css" href="../../static/css/admin.css"/>
    <link rel="stylesheet" href="../../static/css/all.min.css"/>
    <script src="../../static/layui/layui.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../static/js/jquery-3.3.1.min.js" type="text/javascript" charset="utf-8"></script>
    <!--[if IE 8]>
    <script type="text/javascript" src="../../static/js/jquery-1.11.3.min.js"></script>
    <![endif]-->
    <script src="../../static/js/basic.js"></script>
    <style>
        .inp{
            margin-top: 50px;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="layui-row">
    <p style="height: 34px;width: 100%;line-height: 34px;background-color: lightyellow; text-align: center;"><span class="sign">***</span>请谨慎修改<span class="sign">***</span></p>
    <div class="col-xs-12">
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>购置审批单号申请修改</legend>
        </fieldset>
        <form class="layui-form layui-form-pane" action="">
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">供应商</label>
                <div class="layui-input-block">
                    <input type="text" id="gzHtGhsn" disabled name="htGhsn" class="layui-input" autocomplete="off" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">供方联系人</label>
                <div class="layui-input-block">
                    <input type="text" id="htGhslxr" name="htGhslxr" class="layui-input" autocomplete="off" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">供方联系电话</label>
                <div class="layui-input-block">
                    <input type="text" id="htGhsdh" name="htGhsdh" class="layui-input" placeholder="供方联系电话" autocomplete="off" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label"><span style="color: red;">*</span>购置审批申请单编号</label>
                <div class="layui-input-block">
                    <input style="color: red" id="htGzspd" type="text" name="htGzspd" class="layui-input" autocomplete="off" value="SBCG">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">备注</label>
                <div class="layui-input-block">
                    <input type="text" id="htBz" name="htBz" class="layui-input" autocomplete="off" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">签约日期</label>
                <div class="layui-input-block">
                    <input type="text" id="date2" name="htQytime" class="layui-input" autocomplete="off" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">到货时间</label>
                <div class="layui-input-block">
                    <input type="text" id="htDhtime" name="htDhtime" class="layui-input" autocomplete="off" placeholder="/ 天" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">保险期</label>
                <div class="layui-input-block">
                    <input type="text" id="htBxtime" name="htBxtime" class="layui-input" autocomplete="off" placeholder="/ 天" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">使用科室</label>
                <div class="layui-input-block">
                    <input type="text" id="htSyks" name="htSyks" class="layui-input" autocomplete="off" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">安装地点</label>
                <div class="layui-input-block">
                    <input type="text" id="htAzdd" name="htAzdd" class="layui-input" autocomplete="off" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">来源</label>
                <div class="layui-input-block">
                    <select id="htLy" name="htLy" lay-verify="required">
                        <option value=""></option>
                        <option value="0">1</option>
                        <option value="1">2</option>
                        <option value="2">3</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">采购方式</label>
                <div class="layui-input-block">
                    <select id="htCgfs" name="htCgfs" lay-verify="required">
                        <option value=""></option>
                        <option value="0">1</option>
                        <option value="1">2</option>
                        <option value="2">3</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">申购类别</label>
                <div class="layui-input-block">
                    <select id="htSglb" name="htSglb" lay-verify="required">
                        <option value=""></option>
                        <option value="0">1</option>
                        <option value="1">2</option>
                        <option value="2">3</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">设备用途</label>
                <div class="layui-input-block">
                    <select id="htSbyt" name="htSbyt" lay-verify="required">
                        <option value=""></option>
                        <option value="0">1</option>
                        <option value="1">2</option>
                        <option value="2">3</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item col-md-5">
                <label class="layui-form-label">经费来源</label>
                <div class="layui-input-block">
                    <select id="htJfly" name="htJfly" lay-verify="required">
                        <option value=""></option>
                        <option value="0">1</option>
                        <option value="1">2</option>
                        <option value="2">3</option>
                    </select>
                </div>
            </div>
            <div class="inp layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn layui-btn-normal layui-btn-lg" lay-submit lay-filter="hgsubmit">下一步</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
    // 获取上个页面传递的类型
    var type = window.location.search;
    var ids = parseInt(type.split("=")[1]);
    $(function () {
        $.ajax({
            url:"/htInfo/selectOne?htId="+ids,
            method:"GET",
            dataType:"JSON",
            success:function(res){
                if(res.data != null && res.data != ""){
                    $("#gzHtGhsn").val(res.data.htGhsn);
                    $("#htGhslxr").val(res.data.htGhslxr);
                    $("#htGhsdh").val(res.data.htGhsdh);
                    $("#htGzspd").val(res.data.htGzspd);
                    $("#htBz").val(res.data.htBz);
                    $("#date2").val(res.data.htQytime);
                    $("#htDhtime").val(res.data.htDhtime);
                    $("#htBxtime").val(res.data.htBxtime);
                    $("#htSyks").val(res.data.htSyks);
                    $("#htAzdd").val(res.data.htAzdd);
                    $("#ly").val(res.data.htLy);
                    $("#htCgfs").val(res.data.htCgfs);
                    $("#htSglb").val(res.data.htSglb);
                    $("#htSbyt").val(res.data.htSbyt);
                    $("#htJfly").val(res.data.htJfly);
                }else{
                    console.log("isGml")
                }
            },
            error:function (data) {
                alert("请稍后再试");
                console.log(data);
            }
        })
    });
    layui.use(['laydate','layer','form','jquery'], function(){
        var laydate = layui.laydate
            ,layer = layui.layer
            ,form = layui.form
            ,$ = layui.jquery;
        laydate.render({
            elem:"#date"
        });
        form.on('submit(hhsbumit)', function(data){
            console.log(data.field);
            $.ajax({
                url:"/htInfo/updateInfo?htId="+ids,
                method:"POST",
                data:data.field,
                dataType:"JSON",
                success:function(res){
                    if(res.state === 200){
                        setTimeout(function(){
                            location.href="/supplier/apply/fixing_table.html?htId="+ids;
                        },1000);
                        layer.msg("修改成功");
                    }else{
                        layer.msg("修改失败");
                    }
                },
                error:function(data){
                    layer.msg("请稍后再试");
                    console.log(data);
                }
            });
            return false;
        });
    })
</script>
</body>
</html>